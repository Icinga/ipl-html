# Form element decorators: legacy vs. new implementation

This page presents a side‑by‑side comparison between the legacy decorator (`ipl\Html\Contract\FormElementDecorator`) and the new element decorators (`ipl\Html\Contract\FormElementDecoration`).

Comparison table
----------------
| Topic                   | Legacy decorator                                                                                                                                            | New decorators                                                                                                                                                                                        |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| What it is              | Single object that controls the entire rendering of an element and its surrounding markup                                                                   | Multiple small, focused decorators composed in an ordered chain                                                                                                                                       |
| Interface               | `ipl\Html\Contract\FormElementDecorator`                                                                                                                    | `ipl\Html\Contract\FormElementDecoration`                                                                                                                                                             |
| Configuration           | `$form->setDefaultElementDecorator(new DivDecorator())`                                                                                                     | `$form->setDefaultElementDecorators(['Label', 'RenderElement', 'Description'])`                                                                                                                       |
| Responsibilities        | Coupled in one class: label, element, description, wrapper                                                                                                  | Single responsibility per decorator: label, element, description, wrappers/layout, etc                                                                                                                |
| Output ordering         | Implicit in the decorator implementation; changes require overrides                                                                                         | Explicit and predictable: order equals the sequence in `setDefaultElementDecorators([...])`                                                                                                           |
| Wrappers / layout       | Wrapper typically generated inside the decorator; many codebases assumed `$element->getWrapper()` existed                                                   | HtmlTagDecorator can Wrap / Prepend / Append in the output; does not mutate the element’s wrapper object (no reliance on `getWrapper()` for runtime mutations)                                        |
| Accessibility           | If an `id` attribute is not specified for an element, the label/description may not be properly associated                                                  | If an element is missing an `id` attribute, a unique `id` is generated to ensure accessibility                                                                                                        |
| Customization           | Customization usually requires editing/overriding the decorator class                                                                                       | Customize via options, reordering, conditional decorators, or per‑element decorators                                                                                                                  |
| Per‑element overrides   | Hard: Default applies everywhere                                                                                                                            | Easy: pass `decorators` option on an element to override form defaults for that element                                                                                                               |
| Extensibility / loading | Reuse mainly via inheritance; adding new behaviors is clunky                                                                                                | Composable building blocks; reference built‑ins by short name; register a loader only for your own custom decorators                                                                                  |
| Migration impact        | Legacy code sometimes chained `$form->getElement('x')->getWrapper()->…` assuming a decorator‑created wrapper; removing/changing the decorator breaks chains | New decorators don’t change an element’s wrapper object; produce wrappers only in the rendered output. Prefer `HtmlTagDecorator or explicit container elements instead of mutating a presumed wrapper |
| Example: add a wrapper  | Extend/modify your decorator (e.g., `DivDecorator`)                                                                                                         | Use `HtmlTagDecorator`, optionally with a `condition` for conditional rendering                                                                                                                       |
| Execution time          | Early: on `Form::addElement()` or on `Form::decorate()`                                                                                                     | Late: during render time only, keeping decoration isolated and avoiding unexpected side effects                                                                                                       |
